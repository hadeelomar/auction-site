import{d as j,u as V,j as O,r,c as P,o as R,a as i,b as c,e as t,m as b,g as C,N as z,t as n,f as l,y as D,z as L,n as y,F as E,x as Z,w as q,h as v,A as G,_ as H}from"./index-DcXeo_43.js";const J={class:"page-wrapper"},K={class:"main-content"},Q={class:"page-container"},U={class:"page-header"},W={class:"header-content"},X={class:"page-title"},Y={class:"page-description"},tt={class:"tabs"},et={key:0,class:"loading-state"},st={key:1,class:"error-state"},ot={key:2,class:"auctions-list"},nt={class:"auction-image"},at=["src","alt"],lt={class:"auction-details"},it={class:"auction-title"},ct={class:"auction-stats"},dt={class:"stat"},rt={class:"stat"},ut={class:"auction-meta"},vt={class:"auction-time"},_t={class:"auction-actions"},ht=["onClick","disabled","title"],mt=["onClick","disabled","title"],pt={key:0,class:"empty-state"},ft={class:"modal-body"},gt={class:"modal-footer"},wt=["disabled"],bt={class:"footer"},yt={class:"footer-content"},kt=j({__name:"MyAuctionsPage",setup(At){const{t:a}=V(),S=O(),_=r([]),g=r(!0),p=r(""),u=r(null),w=r(!1),d=r(null),h=r("active"),x=G(),M=e=>S.formatPrice(e),k=P(()=>_.value.filter(e=>h.value==="active"?e.status==="active"||e.ends_at>new Date().toISOString():e.status==="closed"||e.ends_at<=new Date().toISOString())),F=e=>e.ends_at>new Date().toISOString()?"active":"closed",B=e=>e.ends_at>new Date().toISOString()?a("auction.active"):a("auction.closed"),A=async()=>{try{g.value=!0,p.value="";const e=await fetch("http://localhost:8001/api/auth/user/");if(!e.ok)throw new Error("Failed to get user info");const o=await e.json();if(!o.is_authenticated){_.value=[];return}const m=await fetch(`/api/auctions/search/?owner=${o.username}&status=`);if(!m.ok)throw new Error("Failed to fetch auctions");const s=await m.json();_.value=s.auctions}catch(e){p.value=e instanceof Error?e.message:"Failed to load auctions",console.error("Error fetching my auctions:",e)}finally{g.value=!1}},I=e=>{x.push(`/edit/${e.id}`)},T=e=>{d.value=e,w.value=!0},f=()=>{w.value=!1,d.value=null},$=async()=>{if(d.value)try{u.value=d.value.id;const e=await fetch(`/api/auctions/${d.value.id}/`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!e.ok){const o=await e.json();throw new Error(o.error||"Failed to delete auction")}_.value=_.value.filter(o=>o.id!==d.value.id),f()}catch(e){alert(e instanceof Error?e.message:"Failed to delete auction")}finally{u.value=null}};return R(()=>{A()}),(e,o)=>{const m=L("router-link");return c(),i(E,null,[t("div",J,[b(z),t("main",K,[t("div",Q,[t("div",U,[t("div",W,[t("h1",X,n(l(a)("myAuctions.title")),1),t("p",Y,n(l(a)("myAuctions.description")),1)]),b(m,{to:"/create",class:"create-button"},{default:D(()=>[o[3]||(o[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M5 12h14"}),t("path",{d:"M12 5v14"})],-1)),v(" "+n(l(a)("myAuctions.newAuction")),1)]),_:1})]),t("div",tt,[t("button",{onClick:o[0]||(o[0]=s=>h.value="active"),class:y(["tab-button",{active:h.value==="active"}])},n(l(a)("myAuctions.activeAuctions")||"Active Auctions"),3),t("button",{onClick:o[1]||(o[1]=s=>h.value="ended"),class:y(["tab-button",{active:h.value==="ended"}])},n(l(a)("myAuctions.endedAuctions")||"Ended Auctions"),3)]),g.value?(c(),i("div",et,[t("p",null,n(l(a)("myAuctions.loading")),1)])):p.value?(c(),i("div",st,[t("p",null,n(p.value),1),t("button",{onClick:A,class:"retry-button"},n(l(a)("common.retry")),1)])):(c(),i("div",ot,[(c(!0),i(E,null,Z(k.value,s=>(c(),i("div",{key:s.id,class:"auction-card"},[t("div",nt,[t("img",{src:s.image||"/placeholder.svg?height=80&width=80",alt:s.title},null,8,at)]),t("div",lt,[t("h3",it,n(s.title),1),t("div",ct,[t("span",dt,[t("strong",null,n(M(s.current_price)),1),v(" "+n(l(a)("myAuctions.currentBid")),1)]),t("span",rt,[t("strong",null,n(s.bid_count),1),v(" "+n(l(a)("browse.bids")),1)])]),t("div",ut,[t("span",{class:y(["auction-status",F(s)])},n(B(s)),3),t("span",vt,n(s.time_left),1)])]),t("div",_t,[t("button",{onClick:N=>I(s),class:"edit-button",disabled:s.status==="closed"&&s.bid_count>0,title:s.status==="closed"&&s.bid_count>0?"Cannot edit closed auction with bids":"Edit auction"},n(l(a)("common.edit")),9,ht),t("button",{onClick:N=>T(s),class:"delete-button",disabled:u.value===s.id||s.status==="closed"&&s.bid_count>0,title:s.status==="closed"&&s.bid_count>0?"Cannot delete closed auction with bids":"Delete auction"},n(u.value===s.id?l(a)("myAuctions.deleting"):l(a)("common.delete")),9,mt)])]))),128)),k.value.length===0?(c(),i("div",pt,[o[4]||(o[4]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"}),t("path",{d:"m3.3 7 8.7 5 8.7-5"}),t("path",{d:"M12 22V12"})],-1)),t("p",null,n(l(a)("myAuctions.noAuctions")),1),b(m,{to:"/create",class:"empty-create-button"},{default:D(()=>[v(n(l(a)("myAuctions.createFirst")),1)]),_:1})])):C("",!0)]))])]),w.value?(c(),i("div",{key:0,class:"modal-overlay",onClick:f},[t("div",{class:"modal-content",onClick:o[2]||(o[2]=q(()=>{},["stop"]))},[t("div",{class:"modal-header"},[o[5]||(o[5]=t("h3",null,"Delete Auction",-1)),t("button",{onClick:f,class:"modal-close"},"Ã—")]),t("div",ft,[t("p",null,[o[6]||(o[6]=v("Are you sure you want to delete ",-1)),t("strong",null,'"'+n(d.value?.title)+'"',1),o[7]||(o[7]=v("? This action cannot be undone.",-1))])]),t("div",gt,[t("button",{onClick:f,class:"modal-button modal-cancel"},"Cancel"),t("button",{onClick:$,class:"modal-button modal-delete",disabled:u.value!==null},n(u.value?"Deleting...":"Delete"),9,wt)])])])):C("",!0)]),t("footer",bt,[t("div",yt,[t("p",null,"2026 Bido. "+n(l(a)("footer.allRightsReserved")),1)])])],64)}}}),Dt=H(kt,[["__scopeId","data-v-9e431c4e"]]);export{Dt as default};

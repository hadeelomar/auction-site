import{d as A,c as C,x as T,y as B,r as p,o as j,b as n,e as l,f as S,g as t,N as M,h as u,t as c,w as I,k as m,i as v,v as y,n as _,z as $,j as D,p as O,q as z,s as L,_ as R}from"./index-DaiPwfNo.js";const G={class:"page-wrapper"},J={class:"main-content"},H={class:"page-container"},W={class:"page-header"},Y={class:"page-title"},K={class:"page-description"},Q={class:"form-section"},X={class:"form-group"},Z={key:0,class:"error-message"},ee={class:"form-group"},te={key:0,class:"error-message"},ae={class:"form-row"},ie={class:"form-group"},se={class:"input-with-prefix"},oe={key:0,class:"error-message"},re={class:"form-group"},ne={key:0,class:"error-message"},le={class:"form-group"},de={class:"form-section"},ce={key:0,class:"image-preview"},ue=["src"],pe={key:1,class:"upload-placeholder"},ve={key:0,class:"error-message"},ge={class:"form-actions"},me=["disabled"],fe={key:0,class:"general-error"},he={key:1,class:"loading-state"},be=A({__name:"CreateAuctionPage",setup(we){const k=L(),x=T(),d=C(()=>x.name==="edit-auction"),P=C(()=>x.params.id),a=B({title:"",description:"",startingPrice:"",endDate:"",category:"electronics"}),s=p({}),f=p(!1),h=p(null),g=p(""),b=p(null),w=p(!1),E=()=>{const i={};return a.title.trim()?a.title.length<3&&(i.title="Title must be at least 3 characters"):i.title="Title is required",a.description.trim()?a.description.length<10&&(i.description="Description must be at least 10 characters"):i.description="Description is required",a.startingPrice?parseFloat(a.startingPrice)<=0&&(i.startingPrice="Starting price must be greater than 0"):i.startingPrice="Starting price is required",a.endDate?new Date(a.endDate)<=new Date&&(i.endDate="End date must be in the future"):i.endDate="End date is required",s.value=i,Object.keys(i).length===0},U=i=>{const o=i.target.files?.[0];if(o){if(!o.type.startsWith("image/")){s.value.image="Please select an image file";return}if(o.size>10*1024*1024){s.value.image="Image size must be less than 10MB";return}h.value=o,s.value.image="";const r=new FileReader;r.onload=q=>{g.value=q.target?.result},r.readAsDataURL(o)}},V=()=>{h.value=null,g.value="",s.value.image="",b.value&&(b.value.value="")},F=async()=>{if(E()){f.value=!0;try{let i,e;if(d.value){const o={title:a.title,description:a.description,starting_price:a.startingPrice,end_date:new Date(a.endDate).toISOString(),category:a.category};i=await fetch(`/api/auctions/${P.value}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),credentials:"same-origin"}),e=await i.json()}else{const o=new FormData;o.append("title",a.title),o.append("description",a.description),o.append("starting_price",a.startingPrice),o.append("end_date",new Date(a.endDate).toISOString()),o.append("category",a.category),h.value&&o.append("image",h.value),i=await fetch("/api/auctions/create/",{method:"POST",body:o,credentials:"same-origin"}),e=await i.json()}if(!i.ok){i.status===401?s.value.general=`You must be logged in to ${d.value?"edit":"create"} an auction. Please <a href="http://localhost:8000/login/" class="error-link">sign in</a> first.`:e.error?s.value.general=e.error:s.value.general=`Failed to ${d.value?"update":"create"} auction`;return}d.value?k.push("/auctions"):k.push(`/auction/${e.auction.id}`)}catch(i){s.value.general="Network error. Please try again.",console.error(`${d.value?"Update":"Create"} auction error:`,i)}finally{f.value=!1}}},N=async()=>{if(d.value)try{w.value=!0;const i=await fetch(`/api/auctions/${P.value}/`);if(!i.ok)throw new Error("Failed to fetch auction details");const o=(await i.json()).item;a.title=o.title,a.description=o.description,a.startingPrice=o.starting_price.toString(),a.endDate=new Date(o.ends_at).toISOString().slice(0,16),a.category=o.category||"electronics",g.value=o.image||""}catch(i){s.value.general="Failed to load auction data",console.error("Error loading auction:",i)}finally{w.value=!1}};return j(()=>{N()}),(i,e)=>{const o=z("router-link");return l(),n("div",G,[S(M),t("main",J,[t("div",H,[t("div",W,[t("h1",Y,c(d.value?"Edit Auction":"Create Auction"),1),t("p",K,c(d.value?"Update your auction details":"List a new item for auction"),1)]),w.value?u("",!0):(l(),n("form",{key:0,class:"auction-form",onSubmit:I(F,["prevent"])},[t("div",Q,[e[13]||(e[13]=t("h2",{class:"section-title"},"Item Details",-1)),t("div",X,[e[6]||(e[6]=t("label",{for:"title",class:"form-label"},[v("Title "),t("span",{class:"required"},"*")],-1)),m(t("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=r=>a.title=r),type:"text",class:_(["form-input",{error:s.value.title}]),placeholder:"Enter item title"},null,2),[[y,a.title]]),s.value.title?(l(),n("span",Z,c(s.value.title),1)):u("",!0)]),t("div",ee,[e[7]||(e[7]=t("label",{for:"description",class:"form-label"},[v("Description "),t("span",{class:"required"},"*")],-1)),m(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=r=>a.description=r),class:_(["form-textarea",{error:s.value.description}]),rows:"4",placeholder:"Describe your item in detail"},null,2),[[y,a.description]]),s.value.description?(l(),n("span",te,c(s.value.description),1)):u("",!0)]),t("div",ae,[t("div",ie,[e[9]||(e[9]=t("label",{for:"startingPrice",class:"form-label"},[v("Starting Price "),t("span",{class:"required"},"*")],-1)),t("div",se,[e[8]||(e[8]=t("span",{class:"input-prefix"},"Â£",-1)),m(t("input",{id:"startingPrice","onUpdate:modelValue":e[2]||(e[2]=r=>a.startingPrice=r),type:"number",class:_(["form-input with-prefix",{error:s.value.startingPrice}]),placeholder:"0.00"},null,2),[[y,a.startingPrice]])]),s.value.startingPrice?(l(),n("span",oe,c(s.value.startingPrice),1)):u("",!0)]),t("div",re,[e[10]||(e[10]=t("label",{for:"endDate",class:"form-label"},[v("End Date & Time "),t("span",{class:"required"},"*")],-1)),m(t("input",{id:"endDate","onUpdate:modelValue":e[3]||(e[3]=r=>a.endDate=r),type:"datetime-local",class:_(["form-input",{error:s.value.endDate}])},null,2),[[y,a.endDate]]),s.value.endDate?(l(),n("span",ne,c(s.value.endDate),1)):u("",!0)]),t("div",le,[e[12]||(e[12]=t("label",{for:"category",class:"form-label"},"Category",-1)),m(t("select",{id:"category","onUpdate:modelValue":e[4]||(e[4]=r=>a.category=r),class:"form-input"},[...e[11]||(e[11]=[D('<option value="electronics" data-v-e65e437b>Electronics</option><option value="fashion" data-v-e65e437b>Fashion</option><option value="home" data-v-e65e437b>Home</option><option value="sports" data-v-e65e437b>Sports</option><option value="art" data-v-e65e437b>Art</option><option value="vehicles" data-v-e65e437b>Vehicles</option>',6)])],512),[[$,a.category]])])])]),t("div",de,[e[16]||(e[16]=t("h2",{class:"section-title"},"Item Image",-1)),t("div",{class:"image-upload-area",onClick:e[5]||(e[5]=r=>b.value?.click())},[t("input",{ref_key:"fileInput",ref:b,type:"file",accept:"image/*",onChange:U,style:{display:"none"}},null,544),g.value?(l(),n("div",ce,[t("img",{src:g.value,alt:"Preview"},null,8,ue),t("button",{type:"button",class:"remove-image",onClick:I(V,["stop"])},[...e[14]||(e[14]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])])):(l(),n("div",pe,[...e[15]||(e[15]=[D('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-e65e437b><rect width="18" height="18" x="3" y="3" rx="2" ry="2" data-v-e65e437b></rect><circle cx="9" cy="9" r="2" data-v-e65e437b></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21" data-v-e65e437b></path></svg><p class="upload-text" data-v-e65e437b>Drag and drop an image here, or click to browse</p><p class="upload-hint" data-v-e65e437b>PNG, JPG up to 10MB</p>',3)])]))]),s.value.image?(l(),n("span",ve,c(s.value.image),1)):u("",!0)]),t("div",ge,[S(o,{to:"/",class:"cancel-button"},{default:O(()=>[...e[17]||(e[17]=[v("Cancel",-1)])]),_:1}),t("button",{type:"submit",class:"submit-button",disabled:f.value},[e[18]||(e[18]=D('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-e65e437b><path d="m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8" data-v-e65e437b></path><path d="m16 16 6-6" data-v-e65e437b></path><path d="m8 8 6-6" data-v-e65e437b></path><path d="m9 7 8 8" data-v-e65e437b></path><path d="m21 11-8-8" data-v-e65e437b></path></svg>',1)),v(" "+c(f.value?d.value?"Updating...":"Creating...":d.value?"Update Auction":"Create Auction"),1)],8,me)]),s.value.general?(l(),n("div",fe,c(s.value.general),1)):u("",!0)],32)),w.value?(l(),n("div",he,[...e[19]||(e[19]=[t("p",null,"Loading auction details...",-1)])])):u("",!0)])])])}}}),_e=R(be,[["__scopeId","data-v-e65e437b"]]);export{_e as default};

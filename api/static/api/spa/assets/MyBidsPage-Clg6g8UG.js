import{d as I,u as V,j,r as u,c as A,o as U,a as i,b as n,m as S,e as t,N as z,g as w,t as o,f as r,n as g,F as D,x as E,q as O,h as C,s as q,v as J,y as X,z as Y,_ as G}from"./index-I6Zbi9ll.js";const H={class:"page-wrapper"},K={class:"main-content"},Q={class:"page-container"},W={class:"page-header"},Z={class:"page-title"},tt={class:"page-description"},et={class:"tabs"},st={key:1,class:"loading-state"},at={key:2,class:"error-state"},ot={key:3,class:"bids-list"},it={class:"bid-image"},nt=["src","alt"],lt={key:1,class:"no-image"},rt={class:"bid-details"},dt={class:"bid-title"},ct={class:"bid-info"},ut={class:"bid-amount"},vt={class:"bid-current"},pt={class:"bid-meta"},ht={class:"bid-time"},_t={key:0,class:"rebid-form"},bt={class:"rebid-input-group"},mt=["min","placeholder","disabled"],ft={class:"rebid-form-actions"},gt=["disabled"],yt=["onClick","disabled"],wt={class:"bid-actions"},kt=["onClick"],Bt={key:0,class:"empty-state"},Ct={class:"footer"},xt={class:"footer-content"},T="http://localhost:8001/api",Ft=I({__name:"MyBidsPage",setup($t){const{t:l}=V(),M=j(),d=u("active"),b=u([]),k=u(!0),p=u(null),m=u(null),c=u(null),h=u(!1),_=u(null),x=u("success");async function B(){k.value=!0,p.value=null;try{const a=await fetch(`${T}/user/bids/`,{credentials:"include"});if(!a.ok){a.status===401?p.value="Please sign in to view your bids":p.value="Failed to load bids";return}const e=await a.json();b.value=e.bids}catch(a){p.value="Could not connect to the server",console.error(a)}finally{k.value=!1}}function P(a){const v=`; ${document.cookie}`.split(`; ${a}=`);return v.length===2&&v.pop()?.split(";").shift()||null}async function R(a,e){if(c.value){if(c.value<=parseFloat(e)){y(`Bid must be greater than £${parseFloat(e).toLocaleString()}`,"error");return}h.value=!0,_.value=null;try{const v=P("csrftoken"),s=await fetch(`${T}/bids/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":v||""},credentials:"include",body:JSON.stringify({item_id:a,bid_amount:c.value})}),f=await s.json();if(!s.ok){y(f.error||"Failed to place bid","error");return}y("Bid placed successfully!","success"),m.value=null,c.value=null,await B()}catch(v){y("Could not connect to the server","error"),console.error(v)}finally{h.value=!1}}}function y(a,e){_.value=a,x.value=e,setTimeout(()=>{_.value=null},5e3)}function L(a,e){m.value=a,c.value=Math.ceil(parseFloat(e)+1),_.value=null}function N(){m.value=null,c.value=null}const F=A(()=>d.value==="active"?b.value.filter(a=>a.status==="winning"||a.status==="outbid"):d.value==="won"?b.value.filter(a=>a.status==="won"):d.value==="lost"?b.value.filter(a=>a.status==="lost"):b.value),$=a=>M.formatPrice(a);return U(()=>{B()}),(a,e)=>{const v=Y("router-link");return n(),i("div",H,[S(z),t("main",K,[t("div",Q,[t("div",W,[t("h1",Z,o(r(l)("myBids.title")),1),t("p",tt,o(r(l)("myBids.description")),1)]),t("div",et,[t("button",{class:g(["tab",{active:d.value==="active"}]),onClick:e[0]||(e[0]=s=>d.value="active")},o(r(l)("myBids.activeBids")),3),t("button",{class:g(["tab",{active:d.value==="won"}]),onClick:e[1]||(e[1]=s=>d.value="won")},o(r(l)("bids.won")),3),t("button",{class:g(["tab",{active:d.value==="lost"}]),onClick:e[2]||(e[2]=s=>d.value="lost")},o(r(l)("bids.lost")),3)]),_.value?(n(),i("div",{key:0,class:g(["rebid-message",x.value])},o(_.value),3)):w("",!0),k.value?(n(),i("div",st,[...e[4]||(e[4]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Loading your bids...",-1)])])):p.value?(n(),i("div",at,[e[5]||(e[5]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),t("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1)),t("p",null,o(p.value),1),t("button",{class:"retry-btn",onClick:B},"Try Again")])):(n(),i("div",ot,[(n(!0),i(D,null,E(F.value,s=>(n(),i("div",{key:s.id,class:"bid-card"},[t("div",it,[s.image?(n(),i("img",{key:0,src:s.image,alt:s.title},null,8,nt)):(n(),i("div",lt,[...e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),t("circle",{cx:"9",cy:"9",r:"2"}),t("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})],-1)])]))]),t("div",rt,[t("h3",dt,o(s.title),1),t("div",ct,[t("span",ut,[C(o(r(l)("bids.yourBid"))+": ",1),t("strong",null,o($(s.yourBid)),1)]),t("span",vt,[C(o(r(l)("bids.currentBid"))+": ",1),t("strong",null,o($(s.currentBid)),1)])]),t("div",pt,[t("span",{class:g(["bid-status",s.status])},o(s.statusText),3),t("span",ht,o(s.timeLeft),1)]),m.value===s.id?(n(),i("div",_t,[t("div",bt,[e[7]||(e[7]=t("span",{class:"currency-symbol"},"£",-1)),q(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=f=>c.value=f),min:parseFloat(s.currentBid)+1,placeholder:`Min: £${(parseFloat(s.currentBid)+1).toLocaleString()}`,class:"rebid-input",disabled:h.value},null,8,mt),[[J,c.value]])]),t("div",ft,[t("button",{onClick:N,class:"cancel-btn",disabled:h.value},"Cancel",8,gt),t("button",{onClick:f=>R(s.id,s.currentBid),class:"submit-rebid-btn",disabled:h.value||!c.value},o(h.value?"Placing...":"Place Bid"),9,yt)])])):w("",!0)]),t("div",wt,[s.status==="outbid"&&m.value!==s.id?(n(),i("button",{key:0,class:"rebid-button",onClick:f=>L(s.id,s.currentBid)},o(r(l)("bids.rebid")),9,kt)):w("",!0),S(v,{to:`/auction/${s.id}`,class:"view-button"},{default:X(()=>[C(o(r(l)("common.view")),1)]),_:1},8,["to"])])]))),128)),F.value.length===0?(n(),i("div",Bt,[e[8]||(e[8]=O('<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-d708977b><path d="m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8" data-v-d708977b></path><path d="m16 16 6-6" data-v-d708977b></path><path d="m8 8 6-6" data-v-d708977b></path><path d="m9 7 8 8" data-v-d708977b></path><path d="m21 11-8-8" data-v-d708977b></path></svg>',1)),t("p",null,o(r(l)("myBids.noBidsYet")),1)])):w("",!0)]))])]),t("footer",Ct,[t("div",xt,[t("p",null,"2026 Bido. "+o(r(l)("footer.allRightsReserved")),1)])])])}}}),Tt=G(Ft,[["__scopeId","data-v-d708977b"]]);export{Tt as default};

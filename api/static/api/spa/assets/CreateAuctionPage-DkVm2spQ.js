import{d as j,u as M,a as $,c as S,z as E,A as O,r as v,o as T,f as d,g as u,h as C,i as e,N as z,j as g,t as s,l as i,w as I,p as _,k as m,v as A,n as D,B as L,s as H,x as J,m as W,y as Y,_ as G}from"./index-zRjMQsdE.js";const K={class:"page-wrapper"},Q={class:"main-content"},X={class:"page-container"},Z={class:"page-header"},ee={class:"page-title"},te={class:"page-description"},ae={class:"form-section"},oe={class:"section-title"},ie={class:"form-group"},se={for:"title",class:"form-label"},re=["placeholder"],ne={key:0,class:"error-message"},le={class:"form-group"},ce={for:"description",class:"form-label"},de=["placeholder"],ue={key:0,class:"error-message"},pe={class:"form-row"},ge={class:"form-group"},ve={for:"startingPrice",class:"form-label"},me={class:"input-with-prefix"},he={class:"input-prefix"},_e={key:0,class:"error-message"},fe={class:"form-group"},ye={for:"endDate",class:"form-label"},we={key:0,class:"error-message"},be={class:"form-group"},Ae={for:"category",class:"form-label"},De={value:"electronics"},ke={value:"fashion"},Pe={value:"home"},xe={value:"sports"},Se={value:"art"},Ce={value:"vehicles"},Ie={class:"form-section"},Fe={class:"section-title"},Re={key:0,class:"image-preview"},Ve=["src"],Ne={key:1,class:"upload-placeholder"},Ue={class:"upload-text"},qe={class:"upload-hint"},Be={key:0,class:"error-message"},je={class:"form-actions"},Me=["disabled"],$e={key:0,class:"general-error"},Ee={key:1,class:"loading-state"},Oe={class:"footer"},Te={class:"footer-content"},ze=j({__name:"CreateAuctionPage",setup(Le){const{t}=M(),F=$(),k=Y(),P=E(),p=S(()=>P.name==="edit-auction"),x=S(()=>P.params.id),o=O({title:"",description:"",startingPrice:"",endDate:"",category:"electronics"}),n=v({}),f=v(!1),y=v(null),h=v(""),w=v(null),b=v(!1),R=()=>{const r={};return o.title.trim()?o.title.length<3&&(r.title=t("createAuction.titleMinLength")):r.title=t("createAuction.titleRequired"),o.description.trim()?o.description.length<10&&(r.description=t("createAuction.descriptionMinLength")):r.description=t("createAuction.descriptionRequired"),o.startingPrice?parseFloat(o.startingPrice)<=0&&(r.startingPrice=t("createAuction.startingPricePositive")):r.startingPrice=t("createAuction.startingPriceRequired"),o.endDate?new Date(o.endDate)<=new Date&&(r.endDate=t("createAuction.endDateFuture")):r.endDate=t("createAuction.endDateRequired"),n.value=r,Object.keys(r).length===0},V=r=>{const l=r.target.files?.[0];if(l){if(!l.type.startsWith("image/")){n.value.image=t("createAuction.selectImageFile");return}if(l.size>10*1024*1024){n.value.image=t("createAuction.imageSizeError");return}y.value=l,n.value.image="";const c=new FileReader;c.onload=B=>{h.value=B.target?.result},c.readAsDataURL(l)}},N=()=>{y.value=null,h.value="",n.value.image="",w.value&&(w.value.value="")},U=async()=>{if(R()){f.value=!0;try{let r,a;if(p.value){const l={title:o.title,description:o.description,starting_price:o.startingPrice,end_date:new Date(o.endDate).toISOString(),category:o.category};r=await fetch(`/api/auctions/${x.value}/`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),credentials:"same-origin"}),a=await r.json()}else{const l=new FormData;l.append("title",o.title),l.append("description",o.description),l.append("starting_price",o.startingPrice),l.append("end_date",new Date(o.endDate).toISOString()),l.append("category",o.category),y.value&&l.append("image",y.value),r=await fetch("/api/auctions/create/",{method:"POST",body:l,credentials:"same-origin"}),a=await r.json()}if(!r.ok){r.status===401?n.value.general=`You must be logged in to ${p.value?"edit":"create"} an auction. Please <a href="http://localhost:8000/login/" class="error-link">sign in</a> first.`:a.error?n.value.general=a.error:n.value.general=`Failed to ${p.value?"update":"create"} auction`;return}p.value?k.push("/auctions"):k.push(`/auction/${a.auction.id}`)}catch(r){n.value.general="Network error. Please try again.",console.error(`${p.value?"Update":"Create"} auction error:`,r)}finally{f.value=!1}}},q=async()=>{if(p.value)try{b.value=!0;const r=await fetch(`/api/auctions/${x.value}/`);if(!r.ok)throw new Error("Failed to fetch auction details");const l=(await r.json()).item;o.title=l.title,o.description=l.description,o.startingPrice=l.starting_price.toString(),o.endDate=new Date(l.ends_at).toISOString().slice(0,16),o.category=l.category||"electronics",h.value=l.image||""}catch(r){n.value.general="Failed to load auction data",console.error("Error loading auction:",r)}finally{b.value=!1}};return T(()=>{q()}),(r,a)=>{const l=J("router-link");return u(),d("div",K,[C(z),e("main",Q,[e("div",X,[e("div",Z,[e("h1",ee,s(p.value?i(t)("createAuction.editAuction"):i(t)("createAuction.createAuction")),1),e("p",te,s(p.value?i(t)("createAuction.updateDescription"):i(t)("createAuction.createDescription")),1)]),b.value?g("",!0):(u(),d("form",{key:0,class:"auction-form",onSubmit:I(U,["prevent"])},[e("div",ae,[e("h2",oe,s(i(t)("createAuction.itemDetails")),1),e("div",ie,[e("label",se,[m(s(i(t)("createAuction.title"))+" ",1),a[6]||(a[6]=e("span",{class:"required"},"*",-1))]),_(e("input",{id:"title","onUpdate:modelValue":a[0]||(a[0]=c=>o.title=c),type:"text",class:D(["form-input",{error:n.value.title}]),placeholder:i(t)("createAuction.titlePlaceholder")},null,10,re),[[A,o.title]]),n.value.title?(u(),d("span",ne,s(n.value.title),1)):g("",!0)]),e("div",le,[e("label",ce,[m(s(i(t)("createAuction.description"))+" ",1),a[7]||(a[7]=e("span",{class:"required"},"*",-1))]),_(e("textarea",{id:"description","onUpdate:modelValue":a[1]||(a[1]=c=>o.description=c),class:D(["form-textarea",{error:n.value.description}]),rows:"4",placeholder:i(t)("createAuction.descriptionPlaceholder")},null,10,de),[[A,o.description]]),n.value.description?(u(),d("span",ue,s(n.value.description),1)):g("",!0)]),e("div",pe,[e("div",ge,[e("label",ve,[m(s(i(t)("createAuction.startingPrice"))+" ",1),a[8]||(a[8]=e("span",{class:"required"},"*",-1))]),e("div",me,[e("span",he,s(i(F).currentCurrencySymbol),1),_(e("input",{id:"startingPrice","onUpdate:modelValue":a[2]||(a[2]=c=>o.startingPrice=c),type:"number",class:D(["form-input with-prefix",{error:n.value.startingPrice}]),placeholder:"0.00"},null,2),[[A,o.startingPrice]])]),n.value.startingPrice?(u(),d("span",_e,s(n.value.startingPrice),1)):g("",!0)]),e("div",fe,[e("label",ye,[m(s(i(t)("createAuction.endDate"))+" ",1),a[9]||(a[9]=e("span",{class:"required"},"*",-1))]),_(e("input",{id:"endDate","onUpdate:modelValue":a[3]||(a[3]=c=>o.endDate=c),type:"datetime-local",class:D(["form-input",{error:n.value.endDate}])},null,2),[[A,o.endDate]]),n.value.endDate?(u(),d("span",we,s(n.value.endDate),1)):g("",!0)]),e("div",be,[e("label",Ae,s(i(t)("createAuction.category")),1),_(e("select",{id:"category","onUpdate:modelValue":a[4]||(a[4]=c=>o.category=c),class:"form-input"},[e("option",De,s(i(t)("categories.electronics")),1),e("option",ke,s(i(t)("categories.fashion")),1),e("option",Pe,s(i(t)("categories.home")),1),e("option",xe,s(i(t)("categories.sports")),1),e("option",Se,s(i(t)("categories.art")),1),e("option",Ce,s(i(t)("categories.vehicles")),1)],512),[[L,o.category]])])])]),e("div",Ie,[e("h2",Fe,s(i(t)("createAuction.itemImage")),1),e("div",{class:"image-upload-area",onClick:a[5]||(a[5]=c=>w.value?.click())},[e("input",{ref_key:"fileInput",ref:w,type:"file",accept:"image/*",onChange:V,style:{display:"none"}},null,544),h.value?(u(),d("div",Re,[e("img",{src:h.value,alt:"Preview"},null,8,Ve),e("button",{type:"button",class:"remove-image",onClick:I(N,["stop"])},[...a[10]||(a[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])])):(u(),d("div",Ne,[a[11]||(a[11]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),e("circle",{cx:"9",cy:"9",r:"2"}),e("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})],-1)),e("p",Ue,s(i(t)("createAuction.dragDropText")),1),e("p",qe,s(i(t)("createAuction.uploadHint")),1)]))]),n.value.image?(u(),d("span",Be,s(n.value.image),1)):g("",!0)]),e("div",je,[C(l,{to:"/",class:"cancel-button"},{default:H(()=>[m(s(i(t)("common.cancel")),1)]),_:1}),e("button",{type:"submit",class:"submit-button",disabled:f.value},[a[12]||(a[12]=W('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-72edcb89><path d="m14.5 12.5-8 8a2.119 2.119 0 0 1-3-3l8-8" data-v-72edcb89></path><path d="m16 16 6-6" data-v-72edcb89></path><path d="m8 8 6-6" data-v-72edcb89></path><path d="m9 7 8 8" data-v-72edcb89></path><path d="m21 11-8-8" data-v-72edcb89></path></svg>',1)),m(" "+s(f.value?p.value?i(t)("createAuction.updating"):i(t)("createAuction.creating"):p.value?i(t)("createAuction.submitUpdate"):i(t)("createAuction.submitCreate")),1)],8,Me)]),n.value.general?(u(),d("div",$e,s(n.value.general),1)):g("",!0)],32)),b.value?(u(),d("div",Ee,[e("p",null,s(i(t)("createAuction.loading")),1)])):g("",!0)])]),e("footer",Oe,[e("div",Te,[e("p",null,"2026 Bido. "+s(i(t)("footer.allRightsReserved")),1)])])])}}}),Je=G(ze,[["__scopeId","data-v-72edcb89"]]);export{Je as default};

import{d as S,u as N,a as j,r as _,o as I,f as i,g as c,i as t,h as w,j as b,N as T,t as e,l,s as k,x as V,F as C,q as $,w as P,k as h,n as R,y as L,_ as O}from"./index-zRjMQsdE.js";const q={class:"page-wrapper"},z={class:"main-content"},Z={class:"page-container"},G={class:"page-header"},H={class:"header-content"},J={class:"page-title"},K={class:"page-description"},Q={key:0,class:"loading-state"},U={key:1,class:"error-state"},W={key:2,class:"auctions-list"},X={class:"auction-image"},Y=["src","alt"],tt={class:"auction-details"},et={class:"auction-title"},st={class:"auction-stats"},ot={class:"stat"},nt={class:"stat"},at={class:"auction-meta"},lt={class:"auction-time"},it={class:"auction-actions"},ct=["onClick","disabled","title"],dt=["onClick","disabled","title"],rt={key:0,class:"empty-state"},ut={class:"modal-body"},_t={class:"modal-footer"},ht=["disabled"],vt={class:"footer"},mt={class:"footer-content"},pt=S({__name:"MyAuctionsPage",setup(ft){const{t:a}=N(),A=j(),r=_([]),f=_(!0),m=_(""),u=_(null),g=_(!1),d=_(null),D=L(),E=s=>A.formatPrice(s),y=async()=>{try{f.value=!0,m.value="";const s=await fetch("/api/auth/user/");if(!s.ok)throw new Error("Failed to get user info");const o=await s.json();if(!o.is_authenticated){r.value=[];return}const v=await fetch(`/api/auctions/search/?owner=${o.username}`);if(!v.ok)throw new Error("Failed to fetch auctions");const n=await v.json();r.value=n.auctions}catch(s){m.value=s instanceof Error?s.message:"Failed to load auctions",console.error("Error fetching my auctions:",s)}finally{f.value=!1}},M=s=>{D.push(`/edit/${s.id}`)},x=s=>{d.value=s,g.value=!0},p=()=>{g.value=!1,d.value=null},F=async()=>{if(d.value)try{u.value=d.value.id;const s=await fetch(`/api/auctions/${d.value.id}/`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!s.ok){const o=await s.json();throw new Error(o.error||"Failed to delete auction")}r.value=r.value.filter(o=>o.id!==d.value.id),p()}catch(s){alert(s instanceof Error?s.message:"Failed to delete auction")}finally{u.value=null}};return I(()=>{y()}),(s,o)=>{const v=V("router-link");return c(),i(C,null,[t("div",q,[w(T),t("main",z,[t("div",Z,[t("div",G,[t("div",H,[t("h1",J,e(l(a)("myAuctions.title")),1),t("p",K,e(l(a)("myAuctions.description")),1)]),w(v,{to:"/create",class:"create-button"},{default:k(()=>[o[1]||(o[1]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M5 12h14"}),t("path",{d:"M12 5v14"})],-1)),h(" "+e(l(a)("myAuctions.newAuction")),1)]),_:1})]),f.value?(c(),i("div",Q,[t("p",null,e(l(a)("myAuctions.loading")),1)])):m.value?(c(),i("div",U,[t("p",null,e(m.value),1),t("button",{onClick:y,class:"retry-button"},e(l(a)("common.retry")),1)])):(c(),i("div",W,[(c(!0),i(C,null,$(r.value,n=>(c(),i("div",{key:n.id,class:"auction-card"},[t("div",X,[t("img",{src:n.image||"/placeholder.svg?height=80&width=80",alt:n.title},null,8,Y)]),t("div",tt,[t("h3",et,e(n.title),1),t("div",st,[t("span",ot,[t("strong",null,e(E(n.current_price)),1),h(" "+e(l(a)("myAuctions.currentBid")),1)]),t("span",nt,[t("strong",null,e(n.bid_count),1),h(" "+e(l(a)("browse.bids")),1)])]),t("div",at,[t("span",{class:R(["auction-status",n.ends_at>new Date().toISOString()?"active":"ended"])},e(n.ends_at>new Date().toISOString()?l(a)("auction.active"):l(a)("auction.ended")),3),t("span",lt,e(n.time_left),1)])]),t("div",it,[t("button",{onClick:B=>M(n),class:"edit-button",disabled:n.bid_count>0,title:n.bid_count>0?"Cannot edit auction with bids":"Edit auction"},e(l(a)("common.edit")),9,ct),t("button",{onClick:B=>x(n),class:"delete-button",disabled:u.value===n.id||n.bid_count>0,title:n.bid_count>0?"Cannot delete auction with bids":"Delete auction"},e(u.value===n.id?l(a)("myAuctions.deleting"):l(a)("common.delete")),9,dt)])]))),128)),r.value.length===0?(c(),i("div",rt,[o[2]||(o[2]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"}),t("path",{d:"m3.3 7 8.7 5 8.7-5"}),t("path",{d:"M12 22V12"})],-1)),t("p",null,e(l(a)("myAuctions.noAuctions")),1),w(v,{to:"/create",class:"empty-create-button"},{default:k(()=>[h(e(l(a)("myAuctions.createFirst")),1)]),_:1})])):b("",!0)]))])]),g.value?(c(),i("div",{key:0,class:"modal-overlay",onClick:p},[t("div",{class:"modal-content",onClick:o[0]||(o[0]=P(()=>{},["stop"]))},[t("div",{class:"modal-header"},[o[3]||(o[3]=t("h3",null,"Delete Auction",-1)),t("button",{onClick:p,class:"modal-close"},"Ã—")]),t("div",ut,[t("p",null,[o[4]||(o[4]=h("Are you sure you want to delete ",-1)),t("strong",null,'"'+e(d.value?.title)+'"',1),o[5]||(o[5]=h("? This action cannot be undone.",-1))])]),t("div",_t,[t("button",{onClick:p,class:"modal-button modal-cancel"},"Cancel"),t("button",{onClick:F,class:"modal-button modal-delete",disabled:u.value!==null},e(u.value?"Deleting...":"Delete"),9,ht)])])])):b("",!0)]),t("footer",vt,[t("div",mt,[t("p",null,"2026 Bido. "+e(l(a)("footer.allRightsReserved")),1)])])],64)}}}),wt=O(pt,[["__scopeId","data-v-22311b24"]]);export{wt as default};
